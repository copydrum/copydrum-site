{"version":3,"file":"login-CJ9M5mkm.js","sources":["../../src/pages/auth/login.tsx"],"sourcesContent":["\nimport { useState } from 'react';\nimport { supabase } from '../../lib/supabase';\nimport { kakaoAuth } from '../../lib/kakao';\nimport { googleAuth } from '../../lib/google';\nimport { useNavigate, Link } from 'react-router-dom';\n\nexport default function LoginPage() {\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [kakaoLoading, setKakaoLoading] = useState(false);\n  const [googleLoading, setGoogleLoading] = useState(false);\n  const [error, setError] = useState('');\n  const navigate = useNavigate();\n\n  const handleLogin = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n    setError('');\n\n    try {\n      const { data, error: signInError } = await supabase.auth.signInWithPassword({\n        email,\n        password,\n      });\n\n      if (signInError) {\n        throw signInError;\n      }\n\n      if (data.user) {\n        navigate('/');\n      }\n    } catch (err: any) {\n      console.error('로그인 오류:', err);\n      if (err.message.includes('Invalid login credentials')) {\n        setError('이메일 또는 비밀번호가 올바르지 않습니다.');\n      } else if (err.message.includes('Email not confirmed')) {\n        setError('이메일 인증이 필요합니다. 이메일을 확인해주세요.');\n      } else {\n        setError('로그인에 실패했습니다. 다시 시도해주세요.');\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleKakaoLogin = async () => {\n    setKakaoLoading(true);\n    setError('');\n\n    try {\n      const { userInfo } = await kakaoAuth.login();\n      console.log('카카오 사용자 정보:', userInfo);\n      \n      // Edge Function을 통해 소셜 로그인 처리 - UTF-8 헤더 추가\n      const response = await fetch(`${import.meta.env.VITE_PUBLIC_SUPABASE_URL}/functions/v1/social-auth-handler`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json; charset=utf-8',\n          'apikey': import.meta.env.VITE_PUBLIC_SUPABASE_ANON_KEY,\n          'Accept': 'application/json; charset=utf-8'\n        },\n        body: JSON.stringify({\n          provider: 'kakao',\n          userInfo: userInfo\n        })\n      });\n\n      const result = await response.json();\n      \n      if (!response.ok) {\n        throw new Error(result.error || '카카오 로그인 처리 중 오류가 발생했습니다.');\n      }\n\n      console.log('카카오 로그인 성공:', result);\n\n      // 매직링크를 통한 자동 로그인\n      if (result.authUrl) {\n        // 매직링크에서 토큰 추출하여 세션 설정\n        const url = new URL(result.authUrl);\n        const accessToken = url.searchParams.get('access_token');\n        const refreshToken = url.searchParams.get('refresh_token');\n        \n        if (accessToken && refreshToken) {\n          const { error: sessionError } = await supabase.auth.setSession({\n            access_token: accessToken,\n            refresh_token: refreshToken\n          });\n          \n          if (sessionError) {\n            console.error('세션 설정 오류:', sessionError);\n          }\n        }\n      }\n\n      // 성공 처리\n      navigate('/');\n\n    } catch (error: any) {\n      console.error('카카오 로그인 오류:', error);\n      setError(error.message || '카카오 로그인에 실패했습니다.');\n    } finally {\n      setKakaoLoading(false);\n    }\n  };\n\n  const handleGoogleLogin = async () => {\n    setGoogleLoading(true);\n    setError('');\n\n    try {\n      const { userInfo } = await googleAuth.login();\n      console.log('구글 사용자 정보:', userInfo);\n      \n      // Edge Function을 통해 소셜 로그인 처리 - UTF-8 헤더 추가\n      const response = await fetch(`${import.meta.env.VITE_PUBLIC_SUPABASE_URL}/functions/v1/social-auth-handler`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json; charset=utf-8',\n          'apikey': import.meta.env.VITE_PUBLIC_SUPABASE_ANON_KEY,\n          'Accept': 'application/json; charset=utf-8'\n        },\n        body: JSON.stringify({\n          provider: 'google',\n          userInfo: userInfo\n        })\n      });\n\n      const result = await response.json();\n      \n      if (!response.ok) {\n        throw new Error(result.error || '구글 로그인 처리 중 오류가 발생했습니다.');\n      }\n\n      console.log('구글 로그인 성공:', result);\n\n      // 매직링크를 통한 자동 로그인\n      if (result.authUrl) {\n        // 매직링크에서 토큰 추출하여 세션 설정\n        const url = new URL(result.authUrl);\n        const accessToken = url.searchParams.get('access_token');\n        const refreshToken = url.searchParams.get('refresh_token');\n        \n        if (accessToken && refreshToken) {\n          const { error: sessionError } = await supabase.auth.setSession({\n            access_token: accessToken,\n            refresh_token: refreshToken\n          });\n          \n          if (sessionError) {\n            console.error('세션 설정 오류:', sessionError);\n          }\n        }\n      }\n\n      // 성공 처리\n      navigate('/');\n\n    } catch (error: any) {\n      console.error('구글 로그인 오류:', error);\n      setError(error.message || '구글 로그인에 실패했습니다.');\n    } finally {\n      setGoogleLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8\">\n      <div className=\"max-w-md w-full space-y-8\">\n        <div>\n          <div className=\"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-blue-100\">\n            <i className=\"ri-music-2-line text-2xl text-blue-600\"></i>\n          </div>\n          <h2 className=\"mt-6 text-center text-3xl font-extrabold text-gray-900\">\n            로그인\n          </h2>\n          <p className=\"mt-2 text-center text-sm text-gray-600\">\n            또는{' '}\n            <Link\n              to=\"/auth/register\"\n              className=\"font-medium text-blue-600 hover:text-blue-500\"\n            >\n              새 계정 만들기\n            </Link>\n          </p>\n        </div>\n\n        <form className=\"mt-8 space-y-6\" onSubmit={handleLogin}>\n          {error && (\n            <div className=\"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-md text-sm\">\n              {error}\n            </div>\n          )}\n\n          <div className=\"space-y-4\">\n            <div>\n              <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700\">\n                이메일 주소\n              </label>\n              <input\n                id=\"email\"\n                name=\"email\"\n                type=\"email\"\n                autoComplete=\"email\"\n                required\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n                className=\"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm\"\n                placeholder=\"이메일을 입력하세요\"\n              />\n            </div>\n\n            <div>\n              <label htmlFor=\"password\" className=\"block text-sm font-medium text-gray-700\">\n                비밀번호\n              </label>\n              <input\n                id=\"password\"\n                name=\"password\"\n                type=\"password\"\n                autoComplete=\"current-password\"\n                required\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                className=\"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm\"\n                placeholder=\"비밀번호를 입력하세요\"\n              />\n            </div>\n          </div>\n\n          <div className=\"space-y-4\">\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50\"\n            >\n              {loading ? (\n                <span className=\"flex items-center\">\n                  <i className=\"ri-loader-4-line animate-spin mr-2\"></i>\n                  로그인 중...\n                </span>\n              ) : (\n                '로그인'\n              )}\n            </button>\n\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center\">\n                <input\n                  id=\"remember-me\"\n                  name=\"remember-me\"\n                  type=\"checkbox\"\n                  className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                />\n                <label htmlFor=\"remember-me\" className=\"ml-2 block text-sm text-gray-900\">\n                  로그인 상태 유지\n                </label>\n              </div>\n\n              <div className=\"text-sm\">\n                <Link to=\"/auth/forgot-password\" className=\"font-medium text-blue-600 hover:text-blue-500\">\n                  비밀번호를 잊으셨나요?\n                </Link>\n              </div>\n            </div>\n          </div>\n        </form>\n\n        <div className=\"mt-6\">\n          <div className=\"relative\">\n            <div className=\"absolute inset-0 flex items-center\">\n              <div className=\"w-full border-t border-gray-300\"></div>\n            </div>\n            <div className=\"relative flex justify-center text-sm\">\n              <span className=\"px-2 bg-white text-gray-500\">\n                또는 소셜 계정으로 로그인\n              </span>\n            </div>\n          </div>\n\n          <div className=\"mt-6 grid grid-cols-2 gap-3\">\n            <button\n              onClick={handleKakaoLogin}\n              disabled={kakaoLoading}\n              className=\"w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-yellow-300 text-sm font-medium text-gray-700 hover:bg-yellow-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500 disabled:opacity-50\"\n            >\n              {kakaoLoading ? (\n                <span className=\"flex items-center\">\n                  <i className=\"ri-loader-4-line animate-spin mr-2\"></i>\n                  로그인 중...\n                </span>\n              ) : (\n                <>\n                  <i className=\"ri-kakao-talk-line text-lg mr-2\"></i>\n                  카카오 로그인\n                </>\n              )}\n            </button>\n\n            <button\n              onClick={handleGoogleLogin}\n              disabled={googleLoading}\n              className=\"w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50\"\n            >\n              {googleLoading ? (\n                <span className=\"flex items-center\">\n                  <i className=\"ri-loader-4-line animate-spin mr-2\"></i>\n                  로그인 중...\n                </span>\n              ) : (\n                <>\n                  <i className=\"ri-google-line text-lg mr-2\"></i>\n                  구글 로그인\n                </>\n              )}\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":["LoginPage","email","setEmail","useState","password","setPassword","loading","setLoading","kakaoLoading","setKakaoLoading","googleLoading","setGoogleLoading","error","setError","navigate","useNavigate","handleLogin","e","data","signInError","supabase","err","handleKakaoLogin","userInfo","kakaoAuth","response","result","url","accessToken","refreshToken","sessionError","handleGoogleLogin","googleAuth","jsxs","jsx","Link","Fragment"],"mappings":"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"}