import{r as o,u as M,j as e,L as N}from"./index-C3--GnAp.js";import{s as m}from"./supabase-KAXpo3yM.js";import{k as E}from"./kakao-lIUS1Y1u.js";import{g as S}from"./google-Bi8GeQwn.js";function T(){const[u,w]=o.useState(""),[f,k]=o.useState(""),[x,h]=o.useState(!1),[g,p]=o.useState(!1),[b,y]=o.useState(!1),[j,a]=o.useState(""),d=M(),v=async s=>{s.preventDefault(),h(!0),a("");try{const{data:t,error:r}=await m.auth.signInWithPassword({email:u,password:f});if(r)throw r;t.user&&d("/")}catch(t){console.error("로그인 오류:",t),t.message.includes("Invalid login credentials")?a("이메일 또는 비밀번호가 올바르지 않습니다."):t.message.includes("Email not confirmed")?a("이메일 인증이 필요합니다. 이메일을 확인해주세요."):a("로그인에 실패했습니다. 다시 시도해주세요.")}finally{h(!1)}},I=async()=>{p(!0),a("");try{const{userInfo:s}=await E.login();console.log("카카오 사용자 정보:",s);const t=await fetch("https://tkbyemysfmbhqwdvefsi.supabase.co/functions/v1/social-auth-handler",{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8",apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRrYnllbXlzZm1iaHF3ZHZlZnNpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE1NDE4MTIsImV4cCI6MjA3NzExNzgxMn0.af-52GM6sXsaMCoMU9MuHckTQ8zf6M2Qc5CM_ReeNHk",Accept:"application/json; charset=utf-8"},body:JSON.stringify({provider:"kakao",userInfo:s})}),r=await t.json();if(!t.ok)throw new Error(r.error||"카카오 로그인 처리 중 오류가 발생했습니다.");if(console.log("카카오 로그인 성공:",r),r.authUrl){const n=new URL(r.authUrl),l=n.searchParams.get("access_token"),i=n.searchParams.get("refresh_token");if(l&&i){const{error:c}=await m.auth.setSession({access_token:l,refresh_token:i});c&&console.error("세션 설정 오류:",c)}}d("/")}catch(s){console.error("카카오 로그인 오류:",s),a(s.message||"카카오 로그인에 실패했습니다.")}finally{p(!1)}},C=async()=>{y(!0),a("");try{const{userInfo:s}=await S.login();console.log("구글 사용자 정보:",s);const t=await fetch("https://tkbyemysfmbhqwdvefsi.supabase.co/functions/v1/social-auth-handler",{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8",apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRrYnllbXlzZm1iaHF3ZHZlZnNpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE1NDE4MTIsImV4cCI6MjA3NzExNzgxMn0.af-52GM6sXsaMCoMU9MuHckTQ8zf6M2Qc5CM_ReeNHk",Accept:"application/json; charset=utf-8"},body:JSON.stringify({provider:"google",userInfo:s})}),r=await t.json();if(!t.ok)throw new Error(r.error||"구글 로그인 처리 중 오류가 발생했습니다.");if(console.log("구글 로그인 성공:",r),r.authUrl){const n=new URL(r.authUrl),l=n.searchParams.get("access_token"),i=n.searchParams.get("refresh_token");if(l&&i){const{error:c}=await m.auth.setSession({access_token:l,refresh_token:i});c&&console.error("세션 설정 오류:",c)}}d("/")}catch(s){console.error("구글 로그인 오류:",s),a(s.message||"구글 로그인에 실패했습니다.")}finally{y(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{children:[e.jsx("div",{className:"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-blue-100",children:e.jsx("i",{className:"ri-music-2-line text-2xl text-blue-600"})}),e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"로그인"}),e.jsxs("p",{className:"mt-2 text-center text-sm text-gray-600",children:["또는"," ",e.jsx(N,{to:"/auth/register",className:"font-medium text-blue-600 hover:text-blue-500",children:"새 계정 만들기"})]})]}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:v,children:[j&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-md text-sm",children:j}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"이메일 주소"}),e.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:u,onChange:s=>w(s.target.value),className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"이메일을 입력하세요"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"비밀번호"}),e.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:f,onChange:s=>k(s.target.value),className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"비밀번호를 입력하세요"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("button",{type:"submit",disabled:x,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:x?e.jsxs("span",{className:"flex items-center",children:[e.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"로그인 중..."]}):"로그인"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"remember-me",name:"remember-me",type:"checkbox",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-gray-900",children:"로그인 상태 유지"})]}),e.jsx("div",{className:"text-sm",children:e.jsx(N,{to:"/auth/forgot-password",className:"font-medium text-blue-600 hover:text-blue-500",children:"비밀번호를 잊으셨나요?"})})]})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"또는 소셜 계정으로 로그인"})})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:I,disabled:g,className:"w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-yellow-300 text-sm font-medium text-gray-700 hover:bg-yellow-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500 disabled:opacity-50",children:g?e.jsxs("span",{className:"flex items-center",children:[e.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"로그인 중..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-kakao-talk-line text-lg mr-2"}),"카카오 로그인"]})}),e.jsx("button",{onClick:C,disabled:b,className:"w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:b?e.jsxs("span",{className:"flex items-center",children:[e.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"로그인 중..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-google-line text-lg mr-2"}),"구글 로그인"]})})]})]})]})})}export{T as default};
//# sourceMappingURL=login-CJ9M5mkm.js.map
