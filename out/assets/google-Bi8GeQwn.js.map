{"version":3,"file":"google-Bi8GeQwn.js","sources":["../../src/lib/google.ts"],"sourcesContent":["// Google OAuth 설정\nconst GOOGLE_CLIENT_ID = '315942796574-lj6bfde2nl36bnors1crjpne23ljmas4.apps.googleusercontent.com';\n\ndeclare global {\n  interface Window {\n    google: any;\n    gapi: any;\n  }\n}\n\nexport interface GoogleUserInfo {\n  id: string;\n  email: string;\n  name: string;\n  picture: string;\n  given_name: string;\n  family_name: string;\n}\n\nclass GoogleAuth {\n  private isInitialized = false;\n  private auth2: any = null;\n\n  async initialize(): Promise<void> {\n    if (this.isInitialized) return;\n\n    return new Promise((resolve, reject) => {\n      // Google API 스크립트 로드\n      if (!window.gapi) {\n        const script = document.createElement('script');\n        script.src = 'https://apis.google.com/js/api.js';\n        script.onload = () => {\n          window.gapi.load('auth2', () => {\n            this.initAuth2().then(resolve).catch(reject);\n          });\n        };\n        script.onerror = () => reject(new Error('Google API 스크립트 로드 실패'));\n        document.head.appendChild(script);\n      } else {\n        window.gapi.load('auth2', () => {\n          this.initAuth2().then(resolve).catch(reject);\n        });\n      }\n    });\n  }\n\n  private async initAuth2(): Promise<void> {\n    try {\n      this.auth2 = await window.gapi.auth2.init({\n        client_id: GOOGLE_CLIENT_ID,\n        scope: 'profile email'\n      });\n      this.isInitialized = true;\n    } catch (error) {\n      throw new Error('Google Auth2 초기화 실패');\n    }\n  }\n\n  async login(): Promise<{ userInfo: GoogleUserInfo }> {\n    await this.initialize();\n\n    try {\n      const authInstance = this.auth2;\n      const googleUser = await authInstance.signIn();\n      \n      if (!googleUser.isSignedIn()) {\n        throw new Error('구글 로그인이 취소되었습니다.');\n      }\n\n      const profile = googleUser.getBasicProfile();\n      const userInfo: GoogleUserInfo = {\n        id: profile.getId(),\n        email: profile.getEmail(),\n        name: profile.getName(),\n        picture: profile.getImageUrl(),\n        given_name: profile.getGivenName(),\n        family_name: profile.getFamilyName()\n      };\n\n      return { userInfo };\n    } catch (error: any) {\n      if (error.error === 'popup_closed_by_user') {\n        throw new Error('로그인 창이 닫혔습니다.');\n      }\n      throw new Error(error.message || '구글 로그인에 실패했습니다.');\n    }\n  }\n\n  async logout(): Promise<void> {\n    if (this.auth2 && this.isLoggedIn()) {\n      await this.auth2.signOut();\n    }\n  }\n\n  isLoggedIn(): boolean {\n    return this.auth2 && this.auth2.isSignedIn.get();\n  }\n\n  getCurrentUser(): GoogleUserInfo | null {\n    if (!this.isLoggedIn()) return null;\n\n    const googleUser = this.auth2.currentUser.get();\n    const profile = googleUser.getBasicProfile();\n    \n    return {\n      id: profile.getId(),\n      email: profile.getEmail(),\n      name: profile.getName(),\n      picture: profile.getImageUrl(),\n      given_name: profile.getGivenName(),\n      family_name: profile.getFamilyName()\n    };\n  }\n}\n\nexport const googleAuth = new GoogleAuth();"],"names":["GOOGLE_CLIENT_ID","GoogleAuth","resolve","reject","script","googleUser","profile","error","googleAuth"],"mappings":"AACA,MAAMA,EAAmB,2EAkBzB,MAAMC,CAAW,CACP,cAAgB,GAChB,MAAa,KAErB,MAAM,YAA4B,CAChC,GAAI,MAAK,cAET,OAAO,IAAI,QAAQ,CAACC,EAASC,IAAW,CAEtC,GAAK,OAAO,KAWV,OAAO,KAAK,KAAK,QAAS,IAAM,CAC9B,KAAK,YAAY,KAAKD,CAAO,EAAE,MAAMC,CAAM,CAC7C,CAAC,MAbe,CAChB,MAAMC,EAAS,SAAS,cAAc,QAAQ,EAC9CA,EAAO,IAAM,oCACbA,EAAO,OAAS,IAAM,CACpB,OAAO,KAAK,KAAK,QAAS,IAAM,CAC9B,KAAK,YAAY,KAAKF,CAAO,EAAE,MAAMC,CAAM,CAC7C,CAAC,CACH,EACAC,EAAO,QAAU,IAAMD,EAAO,IAAI,MAAM,uBAAuB,CAAC,EAChE,SAAS,KAAK,YAAYC,CAAM,CAClC,CAKF,CAAC,CACH,CAEA,MAAc,WAA2B,CACvC,GAAI,CACF,KAAK,MAAQ,MAAM,OAAO,KAAK,MAAM,KAAK,CACxC,UAAWJ,EACX,MAAO,eAAA,CACR,EACD,KAAK,cAAgB,EACvB,MAAgB,CACd,MAAM,IAAI,MAAM,qBAAqB,CACvC,CACF,CAEA,MAAM,OAA+C,CACnD,MAAM,KAAK,WAAA,EAEX,GAAI,CAEF,MAAMK,EAAa,MADE,KAAK,MACY,OAAA,EAEtC,GAAI,CAACA,EAAW,aACd,MAAM,IAAI,MAAM,kBAAkB,EAGpC,MAAMC,EAAUD,EAAW,gBAAA,EAU3B,MAAO,CAAE,SATwB,CAC/B,GAAIC,EAAQ,MAAA,EACZ,MAAOA,EAAQ,SAAA,EACf,KAAMA,EAAQ,QAAA,EACd,QAASA,EAAQ,YAAA,EACjB,WAAYA,EAAQ,aAAA,EACpB,YAAaA,EAAQ,cAAA,CAAc,CAG5B,CACX,OAASC,EAAY,CACnB,MAAIA,EAAM,QAAU,uBACZ,IAAI,MAAM,eAAe,EAE3B,IAAI,MAAMA,EAAM,SAAW,iBAAiB,CACpD,CACF,CAEA,MAAM,QAAwB,CACxB,KAAK,OAAS,KAAK,WAAA,GACrB,MAAM,KAAK,MAAM,QAAA,CAErB,CAEA,YAAsB,CACpB,OAAO,KAAK,OAAS,KAAK,MAAM,WAAW,IAAA,CAC7C,CAEA,gBAAwC,CACtC,GAAI,CAAC,KAAK,WAAA,EAAc,OAAO,KAG/B,MAAMD,EADa,KAAK,MAAM,YAAY,IAAA,EACf,gBAAA,EAE3B,MAAO,CACL,GAAIA,EAAQ,MAAA,EACZ,MAAOA,EAAQ,SAAA,EACf,KAAMA,EAAQ,QAAA,EACd,QAASA,EAAQ,YAAA,EACjB,WAAYA,EAAQ,aAAA,EACpB,YAAaA,EAAQ,cAAA,CAAc,CAEvC,CACF,CAEO,MAAME,EAAa,IAAIP"}